import{j as e,O as c,g as l,V as y,B as h,D as E,a9 as P,a2 as w,a3 as b,a4 as n,a5 as t,a6 as f}from"./mui-CYe98n_K.js";import{c as x}from"./vendor-XBP3t-ED.js";import{u as g}from"./useMutation-DaHtIydk.js";import{t as R}from"./index--2Lk4t6e.js";import{P as F}from"./PageContainer-BfQWlLPL.js";import{S as U}from"./SectionCard-4aLOeFJ3.js";import"./utils-BgeKWveL.js";const N=()=>{var p,u;const[a,I]=x.useState(null),[m,d]=x.useState(""),[i,j]=x.useState(null),{mutateAsync:k,isPending:T}=g({mutationFn:async s=>R.importExcel(s)}),{mutateAsync:v,isPending:S}=g({mutationFn:async()=>R.downloadImportTemplate()}),C=async()=>{if(d(""),j(null),!!a)try{const s=await k(a);j(s),d(`Imported ${s.importedCount} of ${s.totalRows}. Failed: ${s.failedCount}`)}catch{d("Import failed.")}},D=async()=>{const s=await v(),o=window.URL.createObjectURL(s),r=document.createElement("a");r.href=o,r.download="timesheet-import-template.xlsx",document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(o)};return e.jsx(F,{title:"Import TimeSheets from Excel",children:e.jsx(U,{children:e.jsxs(c,{spacing:2,children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Choose an .xlsx file to import timesheets. After a successful import, check the TimeSheets list."}),e.jsx(c,{direction:"row",spacing:2,children:e.jsx(y,{variant:"outlined",onClick:D,disabled:S,children:"Download Template"})}),e.jsx(l,{variant:"subtitle2",children:"Template Guidelines"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"- EmployeeId (required): Sistemde var olan çalışan ID’si"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"- ProjectId (optional): İlgili proje ID’si (boş bırakılabilir)"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"- WorkDate (required): Tarih formatı YYYY-MM-DD (örn. 2024-09-09)"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"- HoursWorked (optional): 7.5 gibi ondalıklı değer kabul eder"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"- EmployeeName/ProjectName sütunları rehber amaçlıdır, import sırasında dikkate alınmaz"}),e.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:s=>{var o;return I(((o=s.target.files)==null?void 0:o[0])??null)}}),e.jsxs(c,{direction:"row",spacing:2,children:[e.jsx(y,{variant:"contained",onClick:C,disabled:!a||T,children:"Upload"}),m&&e.jsx(l,{children:m})]}),i&&e.jsxs(h,{children:[e.jsx(E,{sx:{my:2}}),e.jsxs(P,{severity:i.failedCount>0?"warning":"success",children:["Total: ",i.totalRows," | Imported: ",i.importedCount," | Failed: ",i.failedCount]}),((p=i.successRows)==null?void 0:p.length)>0&&e.jsxs(h,{mt:2,children:[e.jsxs(l,{variant:"subtitle1",children:["Successful Rows (",i.successRows.length,")"]}),e.jsxs(w,{size:"small",children:[e.jsx(b,{children:e.jsxs(n,{children:[e.jsx(t,{children:"Row"}),e.jsx(t,{children:"EmployeeId"}),e.jsx(t,{children:"ProjectId"}),e.jsx(t,{children:"WorkDate"}),e.jsx(t,{children:"Hours"}),e.jsx(t,{children:"TimeSheetId"}),e.jsx(t,{children:"Message"})]})}),e.jsx(f,{children:i.successRows.map((s,o)=>e.jsxs(n,{children:[e.jsx(t,{children:s.rowNumber}),e.jsx(t,{children:s.employeeId??""}),e.jsx(t,{children:s.projectId??""}),e.jsx(t,{children:s.workDate??""}),e.jsx(t,{children:s.hoursWorked??""}),e.jsx(t,{children:s.timeSheetId??""}),e.jsx(t,{children:s.message??""})]},`s-${o}`))})]})]}),((u=i.failedRows)==null?void 0:u.length)>0&&e.jsxs(h,{mt:2,children:[e.jsxs(l,{variant:"subtitle1",children:["Failed Rows (",i.failedRows.length,")"]}),e.jsxs(w,{size:"small",children:[e.jsx(b,{children:e.jsxs(n,{children:[e.jsx(t,{children:"Row"}),e.jsx(t,{children:"EmployeeId"}),e.jsx(t,{children:"ProjectId"}),e.jsx(t,{children:"WorkDate"}),e.jsx(t,{children:"Hours"}),e.jsx(t,{children:"Message"})]})}),e.jsx(f,{children:i.failedRows.map((s,o)=>e.jsxs(n,{children:[e.jsx(t,{children:s.rowNumber}),e.jsx(t,{children:s.employeeId??""}),e.jsx(t,{children:s.projectId??""}),e.jsx(t,{children:s.workDate??""}),e.jsx(t,{children:s.hoursWorked??""}),e.jsx(t,{children:s.message??""})]},`f-${o}`))})]})]})]})]})})})};export{N as default};
//# sourceMappingURL=TimeSheetForm-Bg-A-NYi.js.map
