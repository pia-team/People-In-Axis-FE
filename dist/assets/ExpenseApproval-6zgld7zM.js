import{j as i,K as m,O as r,B as y,e as u,G as P}from"./mui-DyWukRpy.js";import{c as g}from"./vendor-zvfEP8kw.js";import{u as z}from"./useQuery-FIUzu5rJ.js";import{u as p}from"./useMutation-C26RIRiP.js";import{e as s}from"./expenseService-Dm-Xs5Id.js";import{D as b}from"./DataGrid-CLJ1UgxA.js";import{k as N}from"./index-CjnpFxxd.js";import"./utils-IvyUKLVR.js";const B=()=>{const[t,h]=g.useState({page:0,pageSize:10}),{data:a,isLoading:x,isError:f,refetch:o}=z({queryKey:["expenses","pending",t.page,t.pageSize],queryFn:async()=>s.getPending({page:t.page,size:t.pageSize}),placeholderData:N}),d=p({mutationFn:({id:e,comments:n})=>s.approve(e,n),onSuccess:()=>o()}),l=p({mutationFn:({id:e,reason:n})=>s.reject(e,n),onSuccess:()=>o()}),c=p({mutationFn:({id:e,reference:n})=>s.reimburse(e,n),onSuccess:()=>o()}),j=(a==null?void 0:a.content)??[],w=(a==null?void 0:a.totalElements)??0,v=g.useMemo(()=>[{field:"employeeName",headerName:"Employee",flex:1.2,minWidth:160},{field:"expenseTypeName",headerName:"Type",flex:1,minWidth:140},{field:"projectName",headerName:"Project",flex:1.2,minWidth:160},{field:"expenseDate",headerName:"Date",width:120},{field:"amount",headerName:"Amount",width:120},{field:"currency",headerName:"Currency",width:100},{field:"status",headerName:"Status",width:140},{field:"actions",headerName:"Actions",width:320,sortable:!1,renderCell:e=>i.jsxs(m,{direction:"row",spacing:1,children:[i.jsx(r,{size:"small",variant:"contained",onClick:()=>d.mutate({id:e.row.id}),disabled:d.isPending,children:"Approve"}),i.jsx(r,{size:"small",variant:"outlined",color:"error",onClick:()=>{const n=window.prompt("Reject reason?")||"";n.trim()&&l.mutate({id:e.row.id,reason:n})},disabled:l.isPending,children:"Reject"}),i.jsx(r,{size:"small",variant:"outlined",onClick:()=>{const n=window.prompt("Reimbursement reference (optional)")||void 0;c.mutate({id:e.row.id,reference:n})},disabled:c.isPending,children:"Reimburse"})]})}],[d.isPending,l.isPending,c.isPending]),S=e=>{h({page:e.page,pageSize:e.pageSize})};return i.jsxs(y,{children:[i.jsx(u,{variant:"h4",component:"h1",gutterBottom:!0,children:"Expense Approval"}),i.jsxs(P,{sx:{p:2,mt:2},children:[i.jsx(m,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:i.jsx(r,{variant:"outlined",onClick:()=>o(),children:"Refresh"})}),i.jsx("div",{style:{height:600,width:"100%"},children:i.jsx(b,{rows:j,columns:v,getRowId:e=>e.id,loading:x,paginationMode:"server",rowCount:w,pageSizeOptions:[5,10,25,50],paginationModel:{page:t.page,pageSize:t.pageSize},onPaginationModelChange:S,disableRowSelectionOnClick:!0})}),f&&i.jsx(u,{variant:"body2",color:"error",sx:{mt:2},children:"Failed to load pending expenses."})]})]})};export{B as default};
//# sourceMappingURL=ExpenseApproval-6zgld7zM.js.map
