import{j as t,O as h,V as c,ad as j,B as f,g as o}from"./mui-CYe98n_K.js";import{c as d}from"./vendor-XBP3t-ED.js";import{u as m}from"./useMutation-DaHtIydk.js";import{t as u}from"./index--2Lk4t6e.js";import{P as g}from"./PageContainer-BfQWlLPL.js";import{S as w}from"./SectionCard-4aLOeFJ3.js";import"./utils-BgeKWveL.js";const v=()=>{const[i,p]=d.useState(null),[n,x]=d.useState(null),a=m({mutationFn:u.downloadImportTemplate,onSuccess:e=>{const s=window.URL.createObjectURL(e),l=document.createElement("a");l.href=s,l.download="timesheet-import-template.xlsx",l.click(),window.URL.revokeObjectURL(s)}}),r=m({mutationFn:e=>u.importExcel(e),onSuccess:e=>x(e)});return t.jsx(g,{title:"Timesheet Import",children:t.jsxs(w,{children:[t.jsxs(h,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:[t.jsx(c,{variant:"outlined",onClick:()=>a.mutate(),disabled:a.isPending,children:"Download Template"}),t.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{var s;return p(((s=e.target.files)==null?void 0:s[0])??null)}}),t.jsx(c,{variant:"contained",onClick:()=>i&&r.mutate(i),disabled:!i||r.isPending,children:"Upload"})]}),(a.isPending||r.isPending)&&t.jsx(j,{}),n&&t.jsxs(f,{sx:{mt:2},children:[t.jsx(o,{variant:"h6",children:"Result"}),t.jsxs(o,{children:["Total Rows: ",n.totalRows]}),t.jsxs(o,{children:["Imported: ",n.importedCount]}),t.jsxs(o,{children:["Failed: ",n.failedCount]})]})]})})};export{v as default};
//# sourceMappingURL=TimeSheetImport-Dnn1h2h3.js.map
