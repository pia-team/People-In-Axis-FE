{"version":3,"file":"TimeSheetApproval-DznQf3VM.js","sources":["../../src/pages/timesheets/TimeSheetApproval.tsx"],"sourcesContent":["import React from 'react';\nimport { Box, Typography, Paper, Stack, Button } from '@mui/material';\nimport { DataGrid, GridColDef, GridPaginationModel } from '@mui/x-data-grid';\nimport { useQuery, useMutation, keepPreviousData } from '@tanstack/react-query';\nimport { timeSheetService } from '@/services/timesheetService';\nimport { TimeSheet } from '@/types';\n\nconst TimeSheetApproval: React.FC = () => {\n  const [paginationModel, setPaginationModel] = React.useState<{ page: number; pageSize: number }>(\n    { page: 0, pageSize: 10 }\n  );\n\n  const { data, isLoading, isError, refetch } = useQuery({\n    queryKey: ['timesheets', 'pending', paginationModel.page, paginationModel.pageSize],\n    queryFn: async () => timeSheetService.getPending({ page: paginationModel.page, size: paginationModel.pageSize }),\n    placeholderData: keepPreviousData,\n  });\n\n  const approveMutation = useMutation({\n    mutationFn: ({ id, comments }: { id: number; comments?: string }) => timeSheetService.approve(id, comments),\n    onSuccess: () => refetch(),\n  });\n\n  const rejectMutation = useMutation({\n    mutationFn: ({ id, reason }: { id: number; reason: string }) => timeSheetService.reject(id, reason),\n    onSuccess: () => refetch(),\n  });\n\n  const rows: TimeSheet[] = data?.content ?? [];\n  const rowCount = data?.totalElements ?? 0;\n\n  const columns = React.useMemo<GridColDef<TimeSheet>[]>(\n    () => [\n      { field: 'employeeName', headerName: 'Employee', flex: 1.2, minWidth: 160 },\n      { field: 'projectName', headerName: 'Project', flex: 1.2, minWidth: 160 },\n      { field: 'workDate', headerName: 'Date', width: 120 },\n      { field: 'hoursWorked', headerName: 'Hours', width: 100 },\n      { field: 'status', headerName: 'Status', width: 140 },\n      {\n        field: 'actions',\n        headerName: 'Actions',\n        width: 220,\n        sortable: false,\n        renderCell: (params) => (\n          <Stack direction=\"row\" spacing={1}>\n            <Button\n              size=\"small\"\n              variant=\"contained\"\n              onClick={() => approveMutation.mutate({ id: params.row.id })}\n              disabled={approveMutation.isPending}\n            >\n              Approve\n            </Button>\n            <Button\n              size=\"small\"\n              variant=\"outlined\"\n              color=\"error\"\n              onClick={() => {\n                const reason = window.prompt('Reject reason?') || '';\n                if (reason.trim()) rejectMutation.mutate({ id: params.row.id, reason });\n              }}\n              disabled={rejectMutation.isPending}\n            >\n              Reject\n            </Button>\n          </Stack>\n        ),\n      },\n    ],\n    [approveMutation.isPending, rejectMutation.isPending]\n  );\n\n  const handlePaginationChange = (model: GridPaginationModel) => {\n    setPaginationModel({ page: model.page, pageSize: model.pageSize });\n  };\n\n  return (\n    <Box>\n      <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n        TimeSheet Approval\n      </Typography>\n      <Paper sx={{ p: 2, mt: 2 }}>\n        <Stack direction=\"row\" spacing={2} alignItems=\"center\" sx={{ mb: 2 }}>\n          <Button variant=\"outlined\" onClick={() => refetch()}>Refresh</Button>\n        </Stack>\n        <div style={{ height: 600, width: '100%' }}>\n          <DataGrid\n            rows={rows}\n            columns={columns}\n            getRowId={(row) => row.id}\n            loading={isLoading}\n            paginationMode=\"server\"\n            rowCount={rowCount}\n            pageSizeOptions={[5, 10, 25, 50]}\n            paginationModel={{ page: paginationModel.page, pageSize: paginationModel.pageSize }}\n            onPaginationModelChange={handlePaginationChange}\n            disableRowSelectionOnClick\n          />\n        </div>\n        {isError && (\n          <Typography variant=\"body2\" color=\"error\" sx={{ mt: 2 }}>\n            Failed to load pending timesheets.\n          </Typography>\n        )}\n      </Paper>\n    </Box>\n  );\n};\n\nexport default TimeSheetApproval;"],"names":["TimeSheetApproval","paginationModel","setPaginationModel","React","data","isLoading","isError","refetch","useQuery","timeSheetService","keepPreviousData","approveMutation","useMutation","id","comments","rejectMutation","reason","rows","rowCount","columns","params","jsxs","Stack","jsx","Button","handlePaginationChange","model","Box","Typography","Paper","DataGrid","row"],"mappings":"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"}