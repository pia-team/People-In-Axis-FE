{"version":3,"file":"DepartmentForm-DARlhVDF.js","sources":["../../src/pages/departments/DepartmentForm.tsx"],"sourcesContent":["import React from 'react';\nimport { Box, Typography, Paper, Stack, TextField, Button } from '@mui/material';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useMutation, useQuery } from '@tanstack/react-query';\nimport { departmentService } from '@/services/departmentService';\nimport { Department, DepartmentCreateDTO, DepartmentUpdateDTO } from '@/types';\n\nconst DepartmentForm: React.FC = () => {\n  const { id } = useParams();\n  const isEdit = Boolean(id);\n  const navigate = useNavigate();\n\n  const { data } = useQuery({\n    queryKey: ['department', id],\n    queryFn: async () => departmentService.getById(Number(id)),\n    enabled: isEdit,\n  });\n\n  const existing = (data as Department | undefined) || undefined;\n\n  const [form, setForm] = React.useState<Partial<DepartmentCreateDTO & DepartmentUpdateDTO>>({\n    name: '',\n    description: '',\n    location: '',\n    budget: undefined,\n    companyId: undefined,\n    managerId: undefined,\n    parentDepartmentId: undefined,\n  });\n\n  React.useEffect(() => {\n    if (existing) {\n      setForm({\n        name: existing.name,\n        description: existing.description || '',\n        location: existing.location || '',\n        budget: existing.budget,\n        companyId: existing.companyId,\n        managerId: existing.managerId ?? undefined,\n        parentDepartmentId: existing.parentDepartmentId ?? undefined,\n      });\n    }\n  }, [existing]);\n\n  const { mutateAsync: save, isPending } = useMutation({\n    mutationFn: async () => {\n      const payload = form as DepartmentCreateDTO;\n      if (!payload.name || !payload.companyId) throw new Error('Name and Company ID are required');\n      if (isEdit) {\n        return departmentService.update(Number(id), payload as DepartmentUpdateDTO);\n      }\n      return departmentService.create(payload);\n    },\n  });\n\n  const handleChange = (key: keyof (DepartmentCreateDTO & DepartmentUpdateDTO)) => (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setForm((prev) => ({ ...prev, [key]: value === '' ? '' : value }));\n  };\n\n  const handleNumber = (key: keyof (DepartmentCreateDTO & DepartmentUpdateDTO)) => (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setForm((prev) => ({ ...prev, [key]: value === '' ? undefined : Number(value) }));\n  };\n\n  const onSubmit = async () => {\n    try {\n      await save();\n      navigate('/departments');\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error(err);\n    }\n  };\n\n  return (\n    <Box>\n      <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n        {isEdit ? 'Edit Department' : 'New Department'}\n      </Typography>\n      <Paper sx={{ p: 3, mt: 2 }}>\n        <Stack spacing={2}>\n          <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2}>\n            <TextField label=\"Name\" value={form.name || ''} onChange={handleChange('name')} fullWidth required />\n            <TextField label=\"Company ID\" type=\"number\" value={form.companyId ?? ''} onChange={handleNumber('companyId')} sx={{ minWidth: 200 }} required />\n            <TextField label=\"Manager ID\" type=\"number\" value={form.managerId ?? ''} onChange={handleNumber('managerId')} sx={{ minWidth: 200 }} />\n          </Stack>\n          <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2}>\n            <TextField label=\"Parent Department ID\" type=\"number\" value={form.parentDepartmentId ?? ''} onChange={handleNumber('parentDepartmentId')} sx={{ minWidth: 200 }} />\n            <TextField label=\"Location\" value={form.location || ''} onChange={handleChange('location')} sx={{ minWidth: 200 }} />\n            <TextField label=\"Budget\" type=\"number\" value={form.budget ?? ''} onChange={handleNumber('budget')} sx={{ minWidth: 200 }} />\n          </Stack>\n          <TextField label=\"Description\" value={form.description || ''} onChange={handleChange('description')} multiline minRows={3} />\n          <Stack direction=\"row\" spacing={2}>\n            <Button variant=\"outlined\" onClick={() => navigate('/departments')}>Cancel</Button>\n            <Button variant=\"contained\" onClick={onSubmit} disabled={isPending}>{isEdit ? 'Save' : 'Create'}</Button>\n          </Stack>\n        </Stack>\n      </Paper>\n    </Box>\n  );\n};\n\nexport default DepartmentForm;"],"names":["DepartmentForm","id","useParams","isEdit","navigate","useNavigate","data","useQuery","departmentService","existing","form","setForm","React","save","isPending","useMutation","payload","handleChange","key","e","value","prev","handleNumber","onSubmit","err","Box","jsx","Typography","Paper","jsxs","Stack","TextField","Button"],"mappings":"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"}