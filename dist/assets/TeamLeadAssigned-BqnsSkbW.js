import{j as t,O as P,V as u,B as I,g as M,a8 as v}from"./mui-CYe98n_K.js";import{c as n}from"./vendor-XBP3t-ED.js";import{b as y,t as h,k as N}from"./index--2Lk4t6e.js";import{u as f}from"./useMutation-DaHtIydk.js";import{P as z}from"./PageContainer-BfQWlLPL.js";import{S as L}from"./SectionCard-4aLOeFJ3.js";import{E as O,s as b}from"./dataGridStyles-CXweFaFc.js";import{C as _}from"./ConfirmDialog-Xg6DaLa-.js";import{D as k}from"./DataGrid-BXsRbnco.js";import"./utils-BgeKWveL.js";const U=()=>{const[i,R]=n.useState({page:0,pageSize:10}),{data:o,isLoading:E,isError:j,refetch:r}=y({queryKey:["timesheets","teamlead-assigned-rows",i.page,i.pageSize],queryFn:async()=>h.getTeamLeadAssignedRows({page:i.page,size:i.pageSize}),placeholderData:N}),l=f({mutationFn:({timesheetId:e,rowId:a})=>h.approveRow(e,a),onSuccess:()=>r()}),d=f({mutationFn:({timesheetId:e,rowId:a,reason:m})=>h.rejectRow(e,a,m),onSuccess:()=>r()}),p=(o==null?void 0:o.content)??[],S=(o==null?void 0:o.totalElements)??0,[C,c]=n.useState(!1),[g,x]=n.useState(null),[s,w]=n.useState(""),T=n.useMemo(()=>[{field:"id",headerName:"Row ID",width:100},{field:"timesheetId",headerName:"Timesheet ID",width:130},{field:"workDate",headerName:"Date",width:120},{field:"hours",headerName:"Hours",width:100},{field:"status",headerName:"Status",width:160},{field:"assignedToName",headerName:"Assigned To",width:180},{field:"actions",headerName:"Actions",width:240,sortable:!1,renderCell:e=>t.jsxs(P,{direction:"row",spacing:1,children:[t.jsx(u,{size:"small",variant:"contained",onClick:()=>l.mutate({timesheetId:e.row.timesheetId,rowId:e.row.id}),disabled:l.isPending||["TEAM_LEAD_APPROVE","TEAM_LEAD_REJECT","COMPLETED","ADMIN_REJECTED"].includes(String(e.row.status))||!e.row.assignedToEmployeeId,children:"Approve"}),t.jsx(u,{size:"small",variant:"outlined",color:"error",onClick:()=>{x(e.row.id),w(""),c(!0)},disabled:d.isPending||["TEAM_LEAD_APPROVE","TEAM_LEAD_REJECT","COMPLETED","ADMIN_REJECTED"].includes(String(e.row.status))||!e.row.assignedToEmployeeId,children:"Reject"})]})}],[l.isPending,d.isPending]),D=e=>{R({page:e.page,pageSize:e.pageSize})},A=n.useCallback(()=>t.jsx(O,{title:"No assigned rows",description:"There are no timesheet rows assigned to you."}),[r]);return t.jsxs(z,{title:"TeamLead Assigned Rows",actions:t.jsx(u,{variant:"outlined",onClick:()=>r(),children:"Refresh"}),children:[t.jsxs(L,{children:[t.jsx(I,{sx:{height:600,width:"100%"},children:t.jsx(k,{rows:p,columns:T,getRowId:e=>e.id,loading:E,paginationMode:"server",rowCount:S,pageSizeOptions:[5,10,25,50],paginationModel:{page:i.page,pageSize:i.pageSize},onPaginationModelChange:D,disableRowSelectionOnClick:!0,sx:b,slots:{noRowsOverlay:A}})}),j&&t.jsx(M,{variant:"body2",color:"error",sx:{mt:2},children:"Failed to load assigned rows."})]}),t.jsx(_,{open:C,title:"Reject Row",description:"Please provide a reason for rejection.",confirmLabel:"Reject",confirmColor:"error",loading:d.isPending,confirmDisabled:s.trim().length===0,onClose:()=>c(!1),onConfirm:()=>{var e;if(g&&s.trim()){const a=(e=p.find(m=>m.id===g))==null?void 0:e.timesheetId;a&&(d.mutate({timesheetId:a,rowId:g,reason:s.trim()}),c(!1))}},children:t.jsx(v,{autoFocus:!0,fullWidth:!0,label:"Reason",multiline:!0,minRows:2,value:s,error:s.trim().length===0,helperText:s.trim().length===0?"Reason is required":"",onChange:e=>w(e.target.value)})})]})};export{U as default};
//# sourceMappingURL=TeamLeadAssigned-BqnsSkbW.js.map
