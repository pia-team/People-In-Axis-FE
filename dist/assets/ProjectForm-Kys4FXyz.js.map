{"version":3,"file":"ProjectForm-Kys4FXyz.js","sources":["../../src/pages/projects/ProjectForm.tsx"],"sourcesContent":["import React from 'react';\nimport { Box, Typography, Paper, Stack, TextField, Button } from '@mui/material';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useMutation, useQuery } from '@tanstack/react-query';\nimport { projectService } from '@/services/projectService';\nimport { Project, ProjectCreateDTO, ProjectUpdateDTO } from '@/types';\n\nconst ProjectForm: React.FC = () => {\n  const { id } = useParams();\n  const isEdit = Boolean(id);\n  const navigate = useNavigate();\n\n  const { data } = useQuery({\n    queryKey: ['project', id],\n    queryFn: async () => projectService.getById(Number(id)),\n    enabled: isEdit,\n  });\n\n  const existing = (data as Project | undefined) || undefined;\n\n  const [form, setForm] = React.useState<Partial<ProjectCreateDTO & ProjectUpdateDTO>>({\n    name: '',\n    description: '',\n    startDate: '',\n    endDate: '',\n    deadline: '',\n    status: '',\n    budget: undefined,\n    spentAmount: undefined,\n    currency: '',\n    completionPercentage: undefined,\n    priority: '',\n    clientName: '',\n    clientContact: '',\n    companyId: undefined,\n    projectManagerId: undefined,\n  });\n\n  React.useEffect(() => {\n    if (existing) {\n      setForm({\n        name: existing.name,\n        description: existing.description,\n        startDate: existing.startDate || '',\n        endDate: existing.endDate || '',\n        deadline: existing.deadline || '',\n        status: existing.status || '',\n        budget: existing.budget as any,\n        spentAmount: existing.spentAmount as any,\n        currency: existing.currency || '',\n        completionPercentage: existing.completionPercentage,\n        priority: existing.priority || '',\n        clientName: existing.clientName || '',\n        clientContact: existing.clientContact || '',\n        companyId: existing.companyId,\n        projectManagerId: existing.projectManagerId,\n      });\n    }\n  }, [existing]);\n\n  const { mutateAsync: save, isPending } = useMutation({\n    mutationFn: async () => {\n      const payload = form as ProjectCreateDTO;\n      if (!payload.name || !payload.companyId) throw new Error('Name and Company ID are required');\n      if (isEdit) {\n        return projectService.update(Number(id), payload as ProjectUpdateDTO);\n      }\n      return projectService.create(payload);\n    },\n  });\n\n  const handleChange = (key: keyof (ProjectCreateDTO & ProjectUpdateDTO)) => (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setForm((prev) => ({ ...prev, [key]: value === '' ? '' : value }));\n  };\n\n  const handleNumber = (key: keyof (ProjectCreateDTO & ProjectUpdateDTO)) => (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setForm((prev) => ({ ...prev, [key]: value === '' ? undefined : Number(value) }));\n  };\n\n  const onSubmit = async () => {\n    try {\n      await save();\n      navigate('/projects');\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error(err);\n    }\n  };\n\n  return (\n    <Box>\n      <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n        {isEdit ? 'Edit Project' : 'New Project'}\n      </Typography>\n      <Paper sx={{ p: 3, mt: 2 }}>\n        <Stack spacing={2}>\n          <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2}>\n            <TextField label=\"Name\" value={form.name || ''} onChange={handleChange('name')} fullWidth required />\n            <TextField label=\"Company ID\" type=\"number\" value={form.companyId ?? ''} onChange={handleNumber('companyId')} sx={{ minWidth: 200 }} required />\n            <TextField label=\"Manager ID\" type=\"number\" value={form.projectManagerId ?? ''} onChange={handleNumber('projectManagerId')} sx={{ minWidth: 200 }} />\n          </Stack>\n          <TextField label=\"Description\" value={form.description || ''} onChange={handleChange('description')} multiline minRows={3} />\n          <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2}>\n            <TextField label=\"Start Date\" type=\"date\" value={form.startDate || ''} onChange={handleChange('startDate')} InputLabelProps={{ shrink: true }} />\n            <TextField label=\"End Date\" type=\"date\" value={form.endDate || ''} onChange={handleChange('endDate')} InputLabelProps={{ shrink: true }} />\n            <TextField label=\"Deadline\" type=\"date\" value={form.deadline || ''} onChange={handleChange('deadline')} InputLabelProps={{ shrink: true }} />\n          </Stack>\n          <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2}>\n            <TextField label=\"Status\" value={form.status || ''} onChange={handleChange('status')} sx={{ minWidth: 200 }} />\n            <TextField label=\"Budget\" type=\"number\" value={form.budget ?? ''} onChange={handleNumber('budget')} sx={{ minWidth: 200 }} />\n            <TextField label=\"Spent\" type=\"number\" value={form.spentAmount ?? ''} onChange={handleNumber('spentAmount')} sx={{ minWidth: 200 }} />\n            <TextField label=\"Currency\" value={form.currency || ''} onChange={handleChange('currency')} sx={{ minWidth: 140 }} />\n          </Stack>\n          <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2}>\n            <TextField label=\"Completion %\" type=\"number\" value={form.completionPercentage ?? ''} onChange={handleNumber('completionPercentage')} sx={{ minWidth: 200 }} />\n            <TextField label=\"Priority\" value={form.priority || ''} onChange={handleChange('priority')} sx={{ minWidth: 200 }} />\n            <TextField label=\"Client\" value={form.clientName || ''} onChange={handleChange('clientName')} sx={{ minWidth: 200 }} />\n            <TextField label=\"Contact\" value={form.clientContact || ''} onChange={handleChange('clientContact')} sx={{ minWidth: 200 }} />\n          </Stack>\n          <Stack direction=\"row\" spacing={2}>\n            <Button variant=\"outlined\" onClick={() => navigate('/projects')}>Cancel</Button>\n            <Button variant=\"contained\" onClick={onSubmit} disabled={isPending}>{isEdit ? 'Save' : 'Create'}</Button>\n          </Stack>\n        </Stack>\n      </Paper>\n    </Box>\n  );\n};\n\nexport default ProjectForm;"],"names":["ProjectForm","id","useParams","isEdit","navigate","useNavigate","data","useQuery","projectService","existing","form","setForm","React","save","isPending","useMutation","payload","handleChange","key","e","value","prev","handleNumber","onSubmit","err","Box","jsx","Typography","Paper","jsxs","Stack","TextField","Button"],"mappings":"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"}