import{j as t,O as N,V as d,B as b,g as k,a8 as D}from"./mui-CYe98n_K.js";import{c as o,u as A}from"./vendor-XBP3t-ED.js";import{b as M,t as c,k as E}from"./index--2Lk4t6e.js";import{u}from"./useMutation-DaHtIydk.js";import{P as O}from"./PageContainer-BfQWlLPL.js";import{S as T}from"./SectionCard-4aLOeFJ3.js";import{E as F,s as B}from"./dataGridStyles-CXweFaFc.js";import{C as W}from"./ConfirmDialog-Xg6DaLa-.js";import{D as q}from"./DataGrid-BXsRbnco.js";import"./utils-BgeKWveL.js";const X=()=>{const[i,h]=o.useState({page:0,pageSize:10}),{data:a,isLoading:f,isError:j,refetch:s}=M({queryKey:["timesheets","admin-pending",i.page,i.pageSize],queryFn:async()=>c.getAdminPending({page:i.page,size:i.pageSize}),placeholderData:E}),l=u({mutationFn:({id:e})=>c.adminApprove(e),onSuccess:()=>s()}),r=u({mutationFn:({id:e,reason:z})=>c.adminReject(e,z),onSuccess:()=>s()}),S=A(),x=(a==null?void 0:a.content)??[],v=(a==null?void 0:a.totalElements)??0,[C,m]=o.useState(!1),[p,R]=o.useState(null),[n,g]=o.useState(""),w=o.useMemo(()=>[{field:"employeeName",headerName:"Employee",flex:1.2,minWidth:160},{field:"projectName",headerName:"Project",flex:1.2,minWidth:160},{field:"workDate",headerName:"Date",width:120},{field:"hoursWorked",headerName:"Hours",width:100},{field:"status",headerName:"Status",width:140},{field:"baseStatus",headerName:"Base Status",width:180,valueFormatter:({value:e})=>e==="COMPLETED"?"Closed":e},{field:"actions",headerName:"Actions",width:260,sortable:!1,renderCell:e=>t.jsxs(N,{direction:"row",spacing:1,children:[t.jsx(d,{size:"small",variant:"text",onClick:()=>S(`/timesheets/${e.row.id}`),children:"Details"}),t.jsx(d,{size:"small",variant:"contained",color:"success",onClick:()=>l.mutate({id:e.row.id}),disabled:l.isPending,children:"Approve"}),t.jsx(d,{size:"small",variant:"outlined",color:"error",onClick:()=>{R(e.row.id),g(""),m(!0)},disabled:r.isPending,children:"Reject"})]})}],[l.isPending,r.isPending]),P=e=>{h({page:e.page,pageSize:e.pageSize})},y=o.useCallback(()=>t.jsx(F,{title:"No admin pending timesheets",description:"There are no timesheets awaiting admin approval."}),[s]);return t.jsxs(O,{title:"Admin TimeSheet Approval",actions:t.jsx(d,{variant:"outlined",onClick:()=>s(),children:"Refresh"}),children:[t.jsxs(T,{children:[t.jsx(b,{sx:{height:600,width:"100%"},children:t.jsx(q,{rows:x,columns:w,getRowId:e=>e.id,loading:f,paginationMode:"server",rowCount:v,pageSizeOptions:[5,10,25,50],paginationModel:{page:i.page,pageSize:i.pageSize},onPaginationModelChange:P,disableRowSelectionOnClick:!0,sx:B,slots:{noRowsOverlay:y}})}),j&&t.jsx(k,{variant:"body2",color:"error",sx:{mt:2},children:"Failed to load admin pending timesheets."})]}),t.jsx(W,{open:C,title:"Admin Reject Timesheet",description:"Please provide a reason for admin rejection.",confirmLabel:"Reject",confirmColor:"error",loading:r.isPending,confirmDisabled:n.trim().length===0,onClose:()=>m(!1),onConfirm:()=>{p&&n.trim()&&(r.mutate({id:p,reason:n.trim()}),m(!1))},children:t.jsx(D,{autoFocus:!0,fullWidth:!0,label:"Reason",multiline:!0,minRows:2,value:n,error:n.trim().length===0,helperText:n.trim().length===0?"Reason is required":"",onChange:e=>g(e.target.value)})})]})};export{X as default};
//# sourceMappingURL=AdminTimeSheetApproval-CknQbGyw.js.map
