import{j as i,K as c,O as d,B as v,e as p,G as y}from"./mui-DyWukRpy.js";import{c as m}from"./vendor-zvfEP8kw.js";import{u as z}from"./useQuery-FIUzu5rJ.js";import{u as g}from"./useMutation-C26RIRiP.js";import{t as l}from"./timesheetService-QrriUvCW.js";import{D as P}from"./DataGrid-CLJ1UgxA.js";import{k}from"./index-CjnpFxxd.js";import"./utils-IvyUKLVR.js";const E=()=>{const[t,h]=m.useState({page:0,pageSize:10}),{data:o,isLoading:u,isError:f,refetch:n}=z({queryKey:["timesheets","pending",t.page,t.pageSize],queryFn:async()=>l.getPending({page:t.page,size:t.pageSize}),placeholderData:k}),r=g({mutationFn:({id:e,comments:a})=>l.approve(e,a),onSuccess:()=>n()}),s=g({mutationFn:({id:e,reason:a})=>l.reject(e,a),onSuccess:()=>n()}),x=(o==null?void 0:o.content)??[],j=(o==null?void 0:o.totalElements)??0,S=m.useMemo(()=>[{field:"employeeName",headerName:"Employee",flex:1.2,minWidth:160},{field:"projectName",headerName:"Project",flex:1.2,minWidth:160},{field:"workDate",headerName:"Date",width:120},{field:"hoursWorked",headerName:"Hours",width:100},{field:"status",headerName:"Status",width:140},{field:"actions",headerName:"Actions",width:220,sortable:!1,renderCell:e=>i.jsxs(c,{direction:"row",spacing:1,children:[i.jsx(d,{size:"small",variant:"contained",onClick:()=>r.mutate({id:e.row.id}),disabled:r.isPending,children:"Approve"}),i.jsx(d,{size:"small",variant:"outlined",color:"error",onClick:()=>{const a=window.prompt("Reject reason?")||"";a.trim()&&s.mutate({id:e.row.id,reason:a})},disabled:s.isPending,children:"Reject"})]})}],[r.isPending,s.isPending]),w=e=>{h({page:e.page,pageSize:e.pageSize})};return i.jsxs(v,{children:[i.jsx(p,{variant:"h4",component:"h1",gutterBottom:!0,children:"TimeSheet Approval"}),i.jsxs(y,{sx:{p:2,mt:2},children:[i.jsx(c,{direction:"row",spacing:2,alignItems:"center",sx:{mb:2},children:i.jsx(d,{variant:"outlined",onClick:()=>n(),children:"Refresh"})}),i.jsx("div",{style:{height:600,width:"100%"},children:i.jsx(P,{rows:x,columns:S,getRowId:e=>e.id,loading:u,paginationMode:"server",rowCount:j,pageSizeOptions:[5,10,25,50],paginationModel:{page:t.page,pageSize:t.pageSize},onPaginationModelChange:w,disableRowSelectionOnClick:!0})}),f&&i.jsx(p,{variant:"body2",color:"error",sx:{mt:2},children:"Failed to load pending timesheets."})]})]})};export{E as default};
//# sourceMappingURL=TimeSheetApproval-DznQf3VM.js.map
